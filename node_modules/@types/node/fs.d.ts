const fs = require("fs");
const path = require("path");
const { Document, Packer, Paragraph, Media } = require("docx");

const imagesFolderPath = "./imagenes";

async function createDocumentWithImages() {
    const doc = new Document();

    try {
        const images = fs.readdirSync(imagesFolderPath).filter(file =>
            file.endsWith(".jpg") || file.endsWith(".png")
        );

        const paragraphs = images.map((imageName) => {
            const imagePath = path.join(imagesFolderPath, imageName);
            const imageBuffer = fs.readFileSync(imagePath);
            
            return new Paragraph({
                children: [
                    Media.addImage(doc, imageBuffer),
                    new Paragraph(`\nNombre de la imagen: ${imageName}`),
                ],
            });
        });

        doc.addSection({
            children: paragraphs,
        });

        const buffer = await Packer.toBuffer(doc);
        fs.writeFileSync("DocumentoConImagenes.docx", buffer);
        console.log("DocumentoConImagenes.docx creado exitosamente.");
    } catch (err) {
        console.error("Error al generar el archivo DOCX:", err);
    }
}

createDocumentWithImages();
